# Автоподтяжка, компиляция и отчёты (Windows + MT5)

Что делает:
- каждые N минут: `git pull` → бэкап прошлого `.ex5` → компиляция через MetaEditor → парсинг `build.log` → отчёт в `reports/*.md` → коммит/пуш.
- опционально создаёт Issue при ошибках (нужен `GITHUB_TOKEN` в среде).

## 1) Настрой конфиг

Файл: `config/build-config.json` — проверь и поправь пути:
- `RepoPath` — путь к папке репозитория (внутри Data Folder MT5).
- `MetaEditorPath` — путь к `metaeditor64.exe`.
- `EAPath` — путь к .mq5 (советнику).
- `BackupDir` — куда складывать резервные `.ex5`.
- `GitHubRepoSlug` — `логин/репозиторий`.
- `CreateIssueOnError` — `true`, чтобы создавать Issue при ошибках.

Опционально: задай переменную среды `GITHUB_TOKEN` с персональным токеном (права `repo`).

## 2) Ручной запуск

Запусти `scripts/run_pull_build_report.bat`.  
Результат:
- `build.log` в корне репозитория,
- отчёт `reports/build_YYYYMMDD_HHMMSS.md` и `reports/last_build.md`,
- при ошибках может создаться Issue.

## 3) Планировщик задач (каждые 10 минут)

**Важно: См. подробное руководство в файле `SCHEDULER_SETUP_GUIDE.md`**

Краткая версия:
- Win+R → `taskschd.msc`
- Создать задачу:
  - Триггер: по расписанию, каждые 10 минут.
  - Действие: Запуск программы `cmd`
  - Аргументы: `/c "ПОЛНЫЙ_ПУТЬ_К_РЕПОЗИТОРИЮ\scripts\run_pull_build_report.bat"`
  - Флажок: "Выполнять с наивысшими правами".
- Готово.

## 4) Где смотреть отчёты

- Папка `reports/` → `last_build.md` и архив по времени.
- Файл `build.log` в корне.
- При ошибках — Issue в GitHub с выдержками из лога.

## 5) Откат

Каждая сборка копирует прежний `.ex5` в `backup/`. Если что-то пошло не так — возьми последнюю резервную и подмени текущую.